INCLUDE_DIRECTORIES(BEFORE
                    ${CMAKE_CURRENT_SOURCE_DIR}/WIN32-Code
                    ${CMAKE_CURRENT_SOURCE_DIR}/include
                    ${CMAKE_CURRENT_SOURCE_DIR}/compat
                    ${CMAKE_CURRENT_SOURCE_DIR})

ADD_DEFINITIONS(-DWIN32)
ADD_DEFINITIONS(-DHAVE_CONFIG_H)

ADD_LIBRARY(event_core STATIC
            event.c buffer.c bufferevent.c bufferevent_sock.c
            bufferevent_pair.c listener.c evmap.c log.c evutil.c
            strlcpy.c signal.c bufferevent_filter.c evthread.c
            bufferevent_ratelim.c evutil_rand.c win32select.c
            evthread_win32.c buffer_iocp.c event_iocp.c
            bufferevent_async.c)

INSTALL(TARGETS event_core
        RUNTIME DESTINATION bin
        LIBRARY DESTINATION lib
        ARCHIVE DESTINATION lib)

INSTALL(FILES
        WIN32-Code/event2/event-config.h
        include/event2/buffer.h include/event2/dns.h
        include/event2/http.h include/event2/rpc_compat.h
        include/event2/buffer_compat.h include/event2/dns_compat.h
        include/event2/http_compat.h include/event2/rpc_struct.h
        include/event2/bufferevent.h include/event2/dns_struct.h
        include/event2/http_struct.h include/event2/tag.h
        include/event2/bufferevent_compat.h include/event2/event.h
        include/event2/keyvalq_struct.h include/event2/tag_compat.h
        include/event2/bufferevent_ssl.h include/event2/event_compat.h
        include/event2/listener.h include/event2/thread.h
        include/event2/bufferevent_struct.h
        include/event2/event_struct.h include/event2/rpc.h
        include/event2/util.h
        DESTINATION include/event2)

INSTALL(FILES
        evdns.h event.h evhttp.h evrpc.h evutil.h
        DESTINATION include)

SET(LIBEVENT_FOUND true)
SET(LIBEVENT_INCLUDE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/include/)
SET(LIBEVENT_LIBRARIES ${CMAKE_CURRENT_BINARY_DIR}/platform.lib)
